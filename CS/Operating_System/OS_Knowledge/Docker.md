# Docker
<iframe width="560" height="315" src="https://www.youtube.com/embed/wW9CAH9nSLs?si=49WzrbpR_DOBC1Vb" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

- Docker는 현대 소프트웨어 개발 및 배포에 있어 핵심적인 역할을 하는 컨테이너화 플랫폼.

## Docker란?
- Docker는 애플리케이션과 그 실행 환경을 컨테이너라는 격리된 환경에 패키징하는 오픈소스 소프트웨어 플랫폼이다. 
- Docker를 사용하면 애플리케이션을 신속하게 개발, 테스트 및 배포할 수 있으며, 다양한 환경에서 일관된 동작을 보장한다.

### Docker의 주요 기능
- **이식성**: Docker 컨테이너는 어디에서나 동일하게 실행된다. 이는 개발 환경과 프로덕션 환경 간의 차이를 최소화한다.
- **경량성**: Docker는 가상 머신과 달리 운영체제를 전체적으로 가상화하지 않기 때문에, 더 적은 리소스를 사용하고 빠르게 시작된다.
- **표준화된 배포**: Docker 이미지를 사용하여 어떤 환경에서든 동일한 방식으로 애플리케이션을 배포할 수 있다.

## Docker 컨테이너란?
- Docker 컨테이너는 Docker 이미지에서 생성된 실행 인스턴스. 
- 컨테이너는 격리된 환경에서 애플리케이션과 필요한 모든 종속성을 함께 실행한다. 
  - 이는 컨테이너 내부의 애플리케이션이 호스트 시스템과 격리되어 실행되며, 다른 컨테이너와 독립적으로 동작한다는 것을 의미한다.

### Docker 컨테이너의 특징
- **격리된 환경**: 각 컨테이너는 다른 컨테이너 및 호스트 시스템으로부터 격리되어 있다.
- **일관된 실행 환경**: 컨테이너 내의 애플리케이션은 어떤 환경에서든 동일하게 실행된다.
- **리소스 효율적**: 컨테이너는 필요한 리소스만을 사용하고, VM보다 가볍고 빠르다.

## Docker 이미지란?
- Docker 이미지는 컨테이너를 생성하기 위한 불변(immutable)의 템플릿. 
- 이미지는 애플리케이션, 실행에 필요한 모든 종속성, 라이브러리, 환경 변수, 설정 파일을 포함한다.

### Docker 이미지의 특징
- **불변성**: 이미지는 변경되지 않으며, 동일한 이미지에서 여러 컨테이너를 생성할 수 있다.
- **레이어 시스템**: Docker 이미지는 여러 레이어로 구성되며, 각 레이어는 변경 사항을 나타낸다. 이를 통해 이미지의 재사용과 효율적인 저장이 가능하다.
- **Dockerfile**: 이미지는 Dockerfile이라는 텍스트 문서를 통해 정의된다. Dockerfile에는 이미지를 만들기 위한 모든 명령어가 포함된다.

## Docker의 환경 차이 최소화

- 개발 환경과 프로덕션 환경은 소프트웨어 개발 과정에서 매우 중요한 두 단계이며, 여러 면에서 차이가 있다.

### 개발 환경
- 개발 환경은 개발자가 코드를 작성하고 초기 테스트를 수행하는 환경이다. 
- **테스트 중심**: 새로운 기능, 버그 수정 등을 테스트하기 위한 환경
- **도구 및 액세스**: 개발 도구, 디버깅 툴, 빠른 액세스 권한 등이 필요
- **변경 빈도**: 개발 환경은 지속적으로 변경되며, 실험적인 시도가 자주 이루어질 수 있다.

### 프로덕션 환경
- 프로덕션 환경은 사용자에게 서비스를 제공하는 최종 단계의 환경이다.
- **안정성 및 보안 중심**: 신뢰성, 성능, 보안이 매우 중요하다.
- **제한된 액세스**: 오직 필요한 인원과 시스템만이 액세스할 수 있다.
- **변경 관리**: 변경사항은 엄격하게 관리되며, 테스트를 거쳐 점진적으로 적용된다.

### Docker가 차이를 최소화하는 이유
- Docker는 개발자의 로컬 환경에서는 잘 동작하는 코드가 프로덕션 환경에서는 예기치 않은 문제를 일으키는 상황을 최소화한다.

1. **일관된 실행 환경**: Docker 컨테이너는 애플리케이션과 그 실행 환경을 포함하기 때문에, 개발 환경에서와 동일한 환경을 프로덕션에서도 재현할 수 있다.
2. **종속성 관리**: 컨테이너 내부에 필요한 라이브러리와 설정이 포함되어 있어, 환경 간 종속성 문제를 방지한다.
3. **배포의 단순화**: Docker 이미지를 통해 개발된 애플리케이션을 프로덕션 환경으로 간편하게 이동시킬 수 있다. 

### 참고 자료
- [Docker 공식 문서](https://docs.docker.com/)

<details><summary> Docker에서 .env 파일 사용하기</summary>

- Docker에서 환경변수를 `.env` 파일을 사용하여 관리할 수 있다.

### **`.env` 파일 사용**: 
- Docker Compose와 함께 `.env` 파일을 사용하여 컨테이너에 환경 변수를 전달할 수 있다. 
- `docker-compose.yml` 파일에서 이 변수들을 참조할 수 있다.
  
  예시 `docker-compose.yml`:
  ```yaml
  version: '3'
  services:
    webapp:
      image: my-webapp
      env_file:
        - .env
  # 이 구성에서 `webapp` 서비스는 `.env` 파일에서 정의된 환경 변수를 사용한다.
  ```
  

- **Dockerfile 내에서 환경 변수 설정**: 
  - `ENV` 지시어를 사용하여 Docker 이미지 빌드 시 환경 변수를 설정할 수 있다. 
  - 하지만, 민감한 정보를 Dockerfile에 직접 포함시키는 것은 권장되지 않는다.

### AWS와 Docker에서 `.env` 파일 사용시 보안 고려사항

- **파일 보안**: `.env` 파일이나 환경 변수 파일은 소스 코드 저장소에 포함되어서는 안 된다. 이 파일은 로컬 개발 환경이나 안전한 위치에만 저장되어야 한다.

- **AWS 보안 모범 사례 준수**: AWS에서는 민감한 데이터를 안전하게 관리하기 위한 여러 도구와 서비스를 제공한다. 예를 들어, AWS Secrets Manager 또는 AWS Parameter Store를 사용하여 민감한 정보를 안전하게 저장하고 관리할 수 있다.

- **컨테이너 보안**: Docker 이미지 또는 컨테이너 내에 민감한 정보를 포함하지 않도록 주의해야 한다. 이러한 정보는 실행 시간에 환경 변수로 전달되어야 한다.

- **네트워크 보안**: AWS 내에서 Docker 컨테이너를 실행할 때, 적절한 네트워크 보안 그룹과 정책을 설정하여 민감한 정보에 대한 접근을 제한한다.
</details>