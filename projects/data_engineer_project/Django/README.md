# 작성한 페이지 및 해결한 어려움들

- 국민여행조사데이터_20230724.csv 파일에는 개인 또는 가족이 여행지를 방문한 뒤 해당 여행지를 평가한 데이터가 있습니다. column은 다음과 같습니다.

| 시군구  | 만족도 | 재방문의도 | 타인추천의도 | 평점   | 법정동코드 |
|-------|-------|-----------|-------------|-------|-----------|
| 설명    | 최하 1 | ~         | 최고 5점      |만족도 1, 재방문의도 1.2, 타인추천의도 1.5의<br> 가중치를 부여하여 곱한 뒤 평균낸 값.       | 시군구에 해당되는 법정동코드 |
| 예시    | 4     | 5         | 3           | 6.377 | 42230     |

| 시군구  | 동반자 | 성별 | 연령대      |
|-------|-------|-----|------------|
| 설명    | 가족   | 남 여  | 15대부터 70대 이상으로 나뉘는 나이 범주 |
| 예시    | 가족   | 여   | 20대       |


## 활동

1. 데이터베이스 모델 정의:
   - `models.py` 파일에 `Place` 모델 클래스를 작성하였습니다. 이 클래스는 여행 장소의 정보를 담는 데이터베이스 모델입니다. `city`, `gender`, `age`, `companion`, `rating` 등 다양한 필드를 정의하였습니다.

2. 데이터 로딩 및 데이터베이스 저장:
   - `load_data_from_csv.py` 파일을 작성하여 CSV 파일에서 데이터를 읽어와 데이터베이스에 저장하는 로직을 구현하였습니다. `Command` 클래스를 상속받아 `handle` 메서드에서 CSV 파일을 열고, `get_or_create`를 통해 데이터를 데이터베이스에 저장했습니다.

3. 메인 페이지 및 결과 페이지 작성:
   - `myapp/templates/myapp/index.html` 파일을 작성하여 메인 페이지를 만들었습니다. 사용자가 성별, 연령대, 동반자 정보를 입력하는 폼을 제공하였습니다.
   - `myapp/templates/myapp/results.html` 파일을 작성하여 추천 결과를 표시하는 페이지를 만들었습니다. `recommended_places` 변수에 담긴 장소들을 순회하며 결과를 출력하도록 구현하였습니다.

4. 뷰 함수 작성:
   - `views.py` 파일에서 뷰 함수를 작성하였습니다. `index` 뷰 함수는 웹 애플리케이션의 메인 페이지를 렌더링합니다. 사용자가 입력하는 폼을 보여줍니다. `recommend` 뷰 함수는 사용자가 입력한 정보를 기반으로 여행 장소를 추천합니다.

5. URL 매핑:
   - `myapp/urls.py` 파일에서 URL 매핑을 설정하였습니다. 뷰 함수와 URL을 연결하고, `results` 뷰를 호출하는 URL 패턴을 추가하였습니다.
  
## 작성한 페이지

1. **myproject/settings.py**:
   - Django 프로젝트의 설정 파일입니다. 데이터베이스 설정, 애플리케이션 등록, 정적 파일 설정 등을 변경하였습니다.
   - 데이터베이스 설정: `DATABASES` 항목을 수정하여 데이터베이스 엔진, 이름, 사용자, 비밀번호 등을 설정하였습니다.
   - 애플리케이션 등록: `INSTALLED_APPS` 항목에 `myapp` 애플리케이션을 등록하여 사용할 애플리케이션을 설정하였습니다.
   - 정적 파일 설정: `STATIC_URL` 항목을 설정하여 정적 파일의 URL을 지정하였습니다.

2. **myapp/templates/myapp/index.html**:
   - 메인 페이지를 위한 HTML 템플릿 파일입니다. 사용자가 성별, 연령대, 동반자 정보를 입력하는 폼을 제공합니다.

3. **myapp/templates/myapp/results.html**:
   - 여행 추천 결과를 표시하는 HTML 템플릿 파일입니다. `recommended_places` 변수에 담긴 장소들을 순회하며 결과를 출력합니다.

4. **myapp/urls.py**:
   - Django 애플리케이션의 URL 매핑을 담당하는 파일입니다. 뷰 함수와 URL을 연결하고, `results` 뷰를 호출하는 URL 패턴을 추가하였습니다.

5. **models.py**:
   - `Place` 모델 클래스를 작성하였습니다. 이 클래스는 각 장소(Place)의 정보를 담고 있습니다. `city`, `gender`, `age`, `companion`, `rating` 등 다양한 필드를 정의했습니다.

6. **load_data_from_csv.py**:
   - Django 커맨드로서, CSV 파일에서 데이터를 읽어와 데이터베이스에 저장하는 로직을 작성했습니다.
   - `Command` 클래스를 상속받아 `handle` 메서드에서 CSV 파일을 열고, `get_or_create`를 통해 데이터를 데이터베이스에 저장했습니다.
   - `python manage.py load_data_from_csv myapp/data/국민여행조사데이터_20230724.csv`

7. **views.py**:
   - `index` 뷰 함수는 웹 애플리케이션의 메인 페이지를 렌더링합니다. 사용자가 입력하는 폼을 보여줍니다.
   - `recommend` 뷰 함수는 사용자가 입력한 정보를 기반으로 여행 장소를 추천합니다.
   - `recommend` 함수에서는 사용자가 입력한 성별, 연령대, 동반자 정보를 가져와 데이터베이스에서 필터링하여 적합한 장소를 추출합니다.

8. **results.html**:
   - 추천 결과를 표시하는 HTML 템플릿 파일입니다. `recommended_places` 변수에 담긴 장소들을 순회하며 결과를 출력합니다. 사용자가 입력한 정보에 따라 필터링된 장소들이 표시됩니다.

## 어려움과 해결 방법:

1. **데이터 불러오기 문제**:
   - 처음에 데이터를 불러올 때 데이터가 제대로 나오지 않는 문제가 있었습니다. 이 문제를 해결하기 위해 CSV 파일과 데이터베이스 필드를 정확히 대응시켜야 하는 것을 확인하고, 데이터를 추가로 불러올 때 기존 데이터를 삭제하고 다시 불러오도록 하였습니다.

2. **데이터 출력 문제**:
   - 사용자로부터 입력받은 데이터를 기반으로 필터링한 뒤, 결과를 출력할 때 데이터가 나오지 않는 문제가 있었습니다. 이 문제를 해결하기 위해 로그를 추가하여 필터링된 데이터와 결과를 확인하였고, 필터링 조건을 정확히 확인하여 문제를 해결하였습니다.

3. **템플릿과 뷰 연결 문제**:
   - 처음에는 결과를 출력하는 템플릿이 뷰와 연결되지 않아 결과가 나오지 않는 문제가 있었습니다. 이 문제를 해결하기 위해 `render` 함수를 사용하여 템플릿과 뷰를 올바르게 연결하여 해결하였습니다.

4. **HTML 폼과 뷰 연동 문제**:
   - 사용자로부터 입력을 받기 위한 HTML 폼과 뷰를 올바르게 연동하지 못해, 사용자의 입력이 뷰로 전달되지 않는 문제가 있었습니다. 이 문제를 해결하기 위해 HTML 폼의 `action` 속성을 올바르게 설정하고, 뷰에서 `POST` 요청을 처리할 수 있도록 `recommend` 함수를 수정하여 해결하였습니다.

5. **데이터 모델 설계**:
   - 처음에 데이터베이스 모델을 어떻게 설계해야 하는지에 대해 고민이 있었습니다. 하지만 `Place` 모델 클래스를 작성하는 과정에서 필요한 필드들을 정의하여 적절한 모델을 설계할 수 있었습니다.

6. **데이터 로딩 및 저장**:
   - CSV 파일에서 데이터를 읽어와서 데이터베이스에 저장하는 과정에서 `get_or_create` 메서드를 활용하여 중복 데이터를 방지하고 데이터를 적절히 저장하는 방법을 선택하였습니다.

7. **템플릿 작성**:
   - HTML 템플릿을 작성하는 과정에서 추천 결과를 출력하는 방법에 대해 고민이 있었습니다. 하지만 `recommended_places` 변수를 템플릿에서 순회하며 결과를 출력하도록 작성하여 문제를 해결하였습니다.

8. **사용자 입력 처리**:
   - 사용자가 입력한 정보를 기반으로 여행 장소를 추천하는 과정에서 `recommend` 뷰 함수에서 사용자의 입력을 어떻게 처리해야 하는지에 대해 고민이 있었습니다. 하지만 POST 요청을 받아 필요한 정보를 추출하여 데이터베이스를 필터링하고 추천 결과를 반환하는 방식으로 해결하였습니다.


