# 6. 자동화 및 최적화

## 6.1 AWS CloudFormation: 인프라 자동화
- **개요**: AWS CloudFormation은 클라우드 리소스를 프로그래밍 방식으로 모델링하고 설정할 수 있는 서비스. 사용하려는 AWS 리소스를 JSON이나 YAML 형식의 템플릿 파일로 작성하여 사용한다. 
  - AWS 리소스에는 EC2 인스턴스, ECS task, CloudWatch log group 등이 있다.
  - AWS 리소스는 이름, 태그, ID 등의 메타데이터를 가지며, AWS Management Console, AWS CLI, AWS SDK 등을 사용하여 검색하고 관리할 수 있다.
- **기능**: 템플릿을 사용하여 AWS 리소스(예: EC2 인스턴스, VPC)를 정의하고, 이를 자동으로 생성하고 관리한다. AWS Resource Groups 참고.
- **이점**: 복잡한 인프라를 일관되고 자동화된 방식으로 배포하고 관리할 수 있어, 시간과 리소스를 절약할 수 있다.

## 6.2 AWS Lambda: 서버리스 컴퓨팅
- **개요**: AWS Lambda는 서버를 관리하지 않고도 코드를 실행할 수 있는 서버리스 컴퓨팅 서비스이다.
  - AWS 서비스 또는 HTTP 엔드포인트를 통해 다양한 이벤트에 반응한다.
- **기능**: 코드를 업로드하고, 이벤트(예: 파일 업로드, HTTP 요청)에 의해 자동으로 트리거된다.
  - Amazon S3에 업로드된 데이터를 실시간으로 처리할 수 있다. 사용자가 S3 버킷에 파일을 업로드하면, AWS Lambda 함수가 자동으로 호출되어 해당 파일을 처리하게 할 수 있다. 또한 웹사이트나 모바일 애플리케이션의 백엔드 로직으로도 응용 가능하다.
  - 사용자 지정 모바일 애플리케이션이 이벤트를 생성하면, AWS 함수가 이벤트를 처리하여 메일을 보내게 할 수 있다.
- **이점**: 서버 관리, 용량 계획 및 유지 보수의 필요성을 없애고, 사용한 컴퓨팅 시간에 대해서만 비용을 지불한다.
- **예시**: [S3 버킷에 파일을 올리고 AWS Lambda로 처리하는 과정](https://m.blog.naver.com/demonic3540/221635831475)
  1. Lambda 함수 생성: AWS Lambda 콘솔에서 새로운 함수를 생성한다. 함수는 S3 버킷에서 파일이 추가되거나 변경될 때 실행될 코드를 포함하고 있다.
  2. IAM 역할 생성 및 연결: Lambda 함수가 S3에 접근할 수 있도록 IAM 역할을 생성하고, 해당 역할에 S3 접근 권한을 부여한다.
  3. S3 버킷과 Lambda 함수 연결: S3 버킷 설정에서 이벤트 알림을 설정하여, 파일 업로드 등의 특정 이벤트가 발생할 때 Lambda 함수를 트리거하도록 설정한다.
  4. Lambda 함수 실행: S3 버킷에 파일이 업로드되면, 설정한 이벤트 알림에 의해 Lambda 함수가 자동으로 실행된다. 이때 Lambda 함수는 업로드된 파일을 처리하고, 필요한 작업을 수행한다.

- **예시**: [백엔드 로직으로 AWS Lambda 사용하기](https://aws.amazon.com/ko/lambda/getting-started/)
  1. API Gateway 설정: AWS API Gateway를 사용하여 HTTP 엔드포인트를 생성한다. 이 엔드포인트는 클라이언트의 요청을 받아 처리한다.
  2. Lambda 함수와 API Gateway 연결: 생성한 API Gateway 엔드포인트를  Lambda 함수에 연결한다. 이러헥 하면, API Gateway를 통해 들어오는 요청이 Lambda 함수를 트리거하게 된다.
  3. 백엔드 로직 구현: Lambda 함수 내부에서는 필요한 백엔드 로직을 구현한다. 이 로직은 클라이언트의 요청에 따라 실행되며, 처리 결과는 클라이언트에게 응답으로 전달된다.

## 6.3 비용 관리 및 최적화 전략
- **개요**: AWS 환경 내에서 리소스 사용을 최적화하여 비용을 효과적으로 관리한다.
- **전략**: 필요하지 않은 리소스의 제거, 예약 인스턴스 및 스팟 인스턴스의 활용, 자동 스케일링 정책 설정 등을 포함한다.
- **도구**: AWS 비용 및 사용량 보고서, AWS 예산, AWS 비용 탐색기 등을 활용하여 비용을 모니터링하고 분석한다.